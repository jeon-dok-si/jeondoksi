# User Scenario & Flow

## 1. Navigation Structure (네비게이션 구조)

### 1.1. 상단 탭 구조
앱의 주요 기능은 상단 탭 바를 통해 접근 가능합니다.
- **홈 (My Page)**: 내 프로필, 캐릭터, 추천 도서
- **독서 (Reading)**: 책 검색 및 독후감 작성
- **퀴즈 (Quiz)**: 퀴즈 도전 및 기록
- **상점 (Shop)**: 아이템 뽑기 및 인벤토리

---

## 2. 온보딩 플로우 (Onboarding Flow)

### 2.1. 회원가입
1. **진입**: 앱을 처음 실행하면 스플래시 화면이 나타난 후 로그인/회원가입 선택 화면으로 이동합니다.
2. **입력 화면**:
   - 이메일 입력 필드 (placeholder: "example@email.com")
   - 비밀번호 입력 필드 (최소 8자, 숨김 처리)
   - 비밀번호 확인 필드
   - 닉네임 입력 필드 (최대 10자)
3. **유효성 검사**:
   - 이메일 형식이 올바르지 않으면 실시간으로 "올바른 이메일 형식을 입력해주세요." 메시지 표시
   - 비밀번호가 8자 미만이면 "비밀번호는 최소 8자 이상이어야 합니다." 메시지 표시
   - 비밀번호 확인이 일치하지 않으면 "비밀번호가 일치하지 않습니다." 메시지 표시
4. **제출**:
   - '가입하기' 버튼 클릭 → 로딩 인디케이터 표시
   - 성공 시: "회원가입이 완료되었습니다!" 토스트 메시지 → 로그인 화면으로 자동 이동
   - 실패 시: "이미 사용 중인 이메일입니다." 또는 "네트워크 오류가 발생했습니다." 에러 메시지 표시

### 2.2. 로그인
1. **진입**: 로그인 화면에서 이메일과 비밀번호를 입력합니다.
2. **입력**:
   - 이메일 필드
   - 비밀번호 필드
   - '로그인' 버튼
3. **제출**:
   - 로딩 인디케이터 표시
   - 성공 시: JWT 토큰을 로컬 스토리지에 저장 → 메인 화면(홈 탭)으로 이동
   - 실패 시: "이메일 또는 비밀번호가 일치하지 않습니다." 에러 메시지 표시

---

## 3. 홈 화면 (My Page)

### 3.1. 화면 구성
로그인 직후 진입하는 화면으로, **심플하고 깔끔하게** 핵심 정보만 표시합니다.

1. **프로필 영역** (상단):
   - 닉네임과 레벨 (예: "독서왕 Lv.5")
   - 경험치 바 (진행 상태만 표시)
   - 보유 포인트 (우측 상단에 간단히)

2. **캐릭터** (중앙):
   - 사용자가 꾸민 캐릭터 이미지
   - 장착한 아이템들이 표시됨

3. **AI 추천 도서** (하단):
   - 제목: "OOO님을 위한 추천"
   - 추천 도서 3권을 카드 형태로 표시
   - 각 책마다:
     - 표지 이미지 (작게)
     - 제목
     - 추천 이유 (한 줄, 예: "당신의 분석가 성향과 95% 일치")
   - 책 카드 클릭 시: 독후감 작성 화면으로 이동

---

## 4. 독서 플로우 (Reading Flow)

### 4.1. 책 검색 (상단 탭 '독서' 클릭)
1. **검색 화면 진입**:
   - 상단에 검색 바 표시 (placeholder: "책 제목을 검색하세요")
   - 하단에 인기 도서 또는 최근 검색어 표시 (선택 사항)

2. **검색어 입력**:
   - 사용자가 "전지적 독자 시점" 입력
   - 입력 도중 자동완성 제안 (선택 사항)

3. **검색 결과 표시**:
   - API 호출 중 로딩 스피너 표시
   - 결과 리스트:
     ```
     [책 표지 섬네일] 전지적 독자 시점
                     저자: 싱숑
                     줄거리: 오직 나만이, 이 세계의 결말을...
     ```
   - 스크롤 가능한 리스트로 여러 검색 결과 표시

4. **책 선택**:
   - 리스트에서 원하는 책 터치
   - '독후감 작성하기' 화면으로 이동

### 4.2. 독후감 작성
1. **화면 구성**:
   - 상단: 선택한 책 정보 (고정 헤더)
     - 표지 이미지 (작은 크기)
     - 제목
     - 저자
   - 중앙: 큰 텍스트 에디터 (멀티라인 입력)
     - placeholder: "책을 읽고 느낀 점을 자유롭게 작성해주세요. (최소 50자)"
     - 실시간 글자 수 카운터 표시 (예: "125 / 최소 50자")
   - 하단: '제출하기' 버튼 (50자 이상일 때만 활성화)

2. **작성 과정**:
   - 사용자가 독후감 입력 (예: "이 책은 회귀물의 클리셰를 완전히 뒤집은...")
   - 글자 수가 50자 미만이면 버튼 비활성화 (회색 처리)
   - 50자 이상이 되면 버튼 활성화 (파란색으로 변경)

3. **제출**:
   - '제출하기' 버튼 클릭
   - 확인 다이얼로그: "독후감을 제출하시겠습니까?"
     - 취소 / 확인 버튼
   - 확인 클릭 시:
     - 전체 화면 로딩 오버레이 표시
     - 로딩 메시지: "AI가 당신의 독후감을 분석하고 있습니다..."
     - 로딩 애니메이션 (스피너 또는 진행 바)

### 4.3. 독후감 제출 완료
1. **결과 화면 진입** (약 1~3초 후):
   - 제목: "독후감이 제출되었습니다!"

2. **AI 피드백**:
   - AI가 생성한 피드백 메시지 표시
     ```
     📝 AI 피드백
     
     "논리적인 분석이 돋보이는 독후감이네요.
     책의 구조와 메시지를 명확히 파악하셨어요!"
     ```
   - (참고: 성향 분석 결과는 백그라운드에서 자동 반영되며, 별도로 표시하지 않음)

3. **보상 표시**:
   - 경험치 획득 애니메이션
     ```
     ✨ +50 XP 획득!
     ```
   - 레벨업 시 추가 팝업:
     ```
     🎉 레벨 업!
     Lv.5 → Lv.6
     새로운 보상이 해금되었습니다!
     ```

4. **다음 단계 버튼**:
   - 하단에 2개의 버튼 표시:
     - **'퀴즈 풀러 가기'** (파란색, 강조) ← 핵심 플로우
     - '홈으로' (회색, 보조)

### 4.4. 독후감 → 퀴즈 연결 플로우 (핵심!)
1. **'퀴즈 풀러 가기' 버튼 클릭**:
   - 분석 결과 화면에서 바로 퀴즈 화면으로 전환
   - 현재 작성한 책(isbn)을 자동으로 전달

2. **퀴즈 로딩**:
   - 전체 화면 로딩 오버레이
   - 로딩 메시지: "퀴즈를 생성하고 있습니다..."
   - 재미 요소: "AI가 당신만을 위한 맞춤 문제를 만들고 있어요!" (사용자의 독후감 내용 반영)
   - 로딩 시간: 약 2~5초 (GPT API 호출)

3. **퀴즈 시작 화면**:
   - 책 정보 표시 (작은 헤더)
   - 안내 문구:
     ```
     🎯 퀴즈에 도전하세요!
     총 5문제 | 60점 이상 통과
     통과 시: 100 XP + 100 Point 획득
     ```
   - '시작하기' 버튼

---

## 5. 퀴즈 플로우 (Quiz Flow)

### 5.1. 문제 풀기 (5문제 순차 진행)
1. **1번 문제 (객관식) 화면**:
   ```
   문제 1 / 5
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   
   Q. 주인공 김독자가 가장 좋아하는 소설의 제목은?
   
   ○ 멸망한 세계에서 살아남는 세 가지 방법
   ○ 전지전능한 독자 시점
   ○ 회귀자의 매뉴얼
   ○ 종말의 도서관
   ○ 마지막 독자
   
   [다음]
   ```
   - 보기를 터치하면 선택 표시 (체크 또는 하이라이트)
   - '다음' 버튼은 선택 후에만 활성화

2. **2번 문제 (객관식)**:
   - 동일한 형식
   - 상단의 진행 바 업데이트 (2/5)

3. **3번 문제 (OX 퀴즈)**:
   ```
   문제 3 / 5
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   
   Q. 주인공은 회귀자다.
   
   [  O  ] [  X  ]
   ```
   - O와 X를 큰 버튼으로 표시
   - 선택 시 즉시 하이라이트

4. **4번 문제 (OX 퀴즈)**:
   - 동일한 OX 형식

5. **5번 문제 (단답형)**:
   ```
   문제 5 / 5
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   
   Q. 이 소설에서 '별'이 상징하는 것은 무엇인가요?
   
   [                입력창                ]
   placeholder: "답을 입력하세요"
   
   [제출하기]
   ```
   - 텍스트 입력 필드 (한 줄 또는 여러 줄)
   - 입력이 있어야 '제출하기' 버튼 활성화

6. **제출**:
   - 5번 문제 완료 후 '제출하기' 버튼 클릭
   - 확인 다이얼로그: "제출하시겠습니까? 제출 후에는 수정할 수 없습니다."
     - 취소 / 제출
   - 제출 클릭 시: 로딩 (1초 내외)

### 5.2. 채점 결과 화면
1. **통과 시 (60점 이상)**:
   ```
   🎉 통과!
   
   당신의 점수: 80점
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   
   문제 1: ✅ 정답
   문제 2: ✅ 정답
   문제 3: ❌ 오답 (정답: X)
   문제 4: ✅ 정답
   문제 5: ✅ 정답
   
   보상:
   ✨ +100 XP
   💰 +100 Point
   
   [홈으로] [다시 풀기]
   ```
   - 통과 축하 애니메이션 (폭죽, 별)
   - 보상 획득 애니메이션 (숫자가 올라가는 효과)
   - 레벨업 시 추가 팝업

2. **실패 시 (60점 미만)**:
   ```
   😢 아쉬워요!
   
   당신의 점수: 40점
   (60점 이상 필요)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   
   문제 1: ✅ 정답
   문제 2: ❌ 오답 (정답: 두 번째 보기)
   문제 3: ❌ 오답 (정답: X)
   문제 4: ✅ 정답
   문제 5: ❌ 오답 (정답: 희망)
   
   다시 도전해보세요!
   
   [홈으로] [다시 풀기]
   ```
   - 격려 메시지 표시
   - 보상 없음 명시
   - 재도전 가능

---

## 6. 상점 플로우 (Shop Flow)

### 6.1. 상점 탭 진입
1. **화면 구성**:
   - 상단: 보유 포인트 표시 (크게)
     ```
     내 포인트: 350 P
     ```
   - 중앙: 가챠 박스 이미지
   - 가격 표시: "1회 뽑기 - 100 P"
   - '뽑기' 버튼 (큰 파란색 버튼)
   - 하단: '인벤토리 보기' 버튼

2. **포인트 부족 시**:
   - '뽑기' 버튼 비활성화 (회색)
   - "포인트가 부족합니다. 퀴즈를 풀어 포인트를 획득하세요!" 메시지

### 6.2. 아이템 뽑기
1. **뽑기 버튼 클릭**:
   - 확인 다이얼로그: "100 포인트를 사용하여 뽑기를 진행하시겠습니까?"
     - 취소 / 확인

2. **뽑기 애니메이션**:
   - 전체 화면으로 애니메이션 재생
   - 상자가 흔들리고 열리는 효과 (2~3초)
   - 빛이 터지며 아이템 등장

3. **결과 표시**:
   - 아이템 이미지 크게 표시
   - 희귀도에 따른 배경 색상:
     - COMMON: 회색
     - RARE: 파란색
     - EPIC: 보라색 (반짝이는 효과)
   - 아이템 정보:
     ```
     🎩 황금 왕관
     등급: EPIC
     카테고리: 모자
     
     인벤토리에 추가되었습니다!
     
     [장착하기] [닫기]
     ```

4. **'장착하기' 클릭 시**:
   - 즉시 캐릭터에 장착
   - "장착되었습니다!" 토스트 메시지
   - 홈 화면으로 이동 → 변경된 캐릭터 확인 가능

### 6.3. 인벤토리 및 꾸미기
1. **인벤토리 화면**:
   - 탭으로 카테고리 분류:
     - 전체 / 모자 / 얼굴 / 옷
   - 그리드 형태로 아이템 표시
   - 각 아이템에 장착 여부 표시 (체크 마크 또는 테두리)

2. **아이템 선택**:
   - 아이템 터치 시 상세 정보 팝업
     ```
     🎩 황금 왕관
     등급: EPIC
     
     [장착하기] / [장착 해제]
     ```

3. **장착 처리**:
   - '장착하기' 클릭
   - 같은 카테고리의 기존 아이템 자동 해제
   - 서버에 저장 (API 호출)
   - "장착되었습니다!" 토스트
   - 상단 미리보기 캐릭터 즉시 업데이트

---

## 7. 엣지 케이스 및 예외 처리

### 8.1. 네트워크 오류
- API 호출 실패 시 에러 화면:
  ```
  ⚠️ 네트워크 오류
  인터넷 연결을 확인해주세요.
  
  [다시 시도]
  ```

### 8.2. 독후감 검증 실패
- AI 생성 감지 시:
  ```
  ❌ 제출 실패
  AI로 생성된 내용으로 의심됩니다.
  직접 작성한 독후감을 제출해주세요.
  
  [확인]
  ```
- 유사도 높음 (표절) 감지 시:
  ```
  ❌ 제출 실패
  기존 독후감과 유사한 내용입니다.
  새로운 내용으로 작성해주세요.
  
  [확인]
  ```

### 8.3. 이미 푼 퀴즈
- 이미 통과한 퀴즈 재도전 시:
  ```
  ℹ️ 안내
  이미 통과한 퀴즈입니다.
  재도전 시 보상은 지급되지 않습니다.
  
  [취소] [계속 풀기]
  ```
